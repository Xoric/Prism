package xoric.prism.com;

import java.util.ArrayList;
import java.util.List;

public class MessageDispatcher
{
	private static final int[] thresholds = { 0, 150, 400 };

	private class MessageEntry
	{
		public final Message message;
		public final int urgency;
		public int ageMs;

		public MessageEntry(Message message)
		{
			this.message = message;
			this.urgency = message.getToken().getUrgency();
		}
	}

	private List<MessageEntry> list;

	public MessageDispatcher()
	{
		list = new ArrayList<MessageEntry>();
	}

	public void addMessage(Message m)
	{
		list.add(new MessageEntry(m));
	}

	public void update(int ms)
	{
		boolean sendNow = false;
		for (MessageEntry e : list)
		{
			e.ageMs += ms;
			sendNow |= e.ageMs >= thresholds[e.urgency];
		}
	}
}
