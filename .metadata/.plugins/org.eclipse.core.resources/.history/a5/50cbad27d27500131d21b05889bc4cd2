package xoric.prism.creator.drawer.view;

import java.awt.BorderLayout;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import java.awt.Insets;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JButton;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JTextField;

import xoric.prism.data.types.Path;
import xoric.prism.swing.input.PathInput;
import xoric.prism.swing.input.fields.PrismIntField;
import xoric.prism.swing.input.fields.PrismTextField;

public class NewModelDialog implements ActionListener
{
	private final JLabel nameLabel;
	private final PrismTextField nameField;

	private final JLabel sizeLabel;
	private final PrismIntField widthField;
	private final PrismIntField heightField;
	private final JPanel sizePanel;

	private final JLabel pathLabel;
	private final JTextField pathField;
	private final JPanel pathPanel;
	private final JButton pathButton;

	public NewModelDialog()
	{
		// model name
		nameLabel = new JLabel("Name");
		nameField = new PrismTextField("NEW MODEL");

		// tile size
		sizeLabel = new JLabel("Tile size");
		widthField = new PrismIntField(12);
		heightField = new PrismIntField(18);
		sizePanel = new JPanel(new GridBagLayout());
		GridBagConstraints c = new GridBagConstraints(0, 0, 1, 1, 0.35, 1.0, GridBagConstraints.NORTHWEST, GridBagConstraints.BOTH,
				new Insets(0, 0, 0, 0), 0, 0);
		sizePanel.add(widthField, c);
		c = new GridBagConstraints(1, 0, 1, 1, 0.1, 1.0, GridBagConstraints.NORTHWEST, GridBagConstraints.BOTH,
				new Insets(0, 0, 0, 0), 0, 0);
		sizePanel.add(new JLabel("x"),c);
		c = new GridBagConstraints(2, 0, 1, 1, 0.35, 1.0, GridBagConstraints.NORTHWEST, GridBagConstraints.BOTH,
				new Insets(0, 0, 0, 0), 0, 0);
		sizePanel.add(heightField,c);
		c = new GridBagConstraints(3, 0, 1, 1, 0.2, 1.0, GridBagConstraints.NORTHWEST, GridBagConstraints.BOTH,
				new Insets(0, 0, 0, 0), 0, 0);
		sizePanel.add(new JLabel(" pixels"),c);

		// working directory
		pathLabel = new JLabel("Working directory");
		pathPanel = new JPanel(new BorderLayout());
		pathField = new JTextField("");
		pathButton = new JButton("...");
		pathButton.addActionListener(this);
		pathPanel.add(BorderLayout.CENTER, pathField);
		pathPanel.add(BorderLayout.EAST, pathButton);
	}

	public void show()
	{
		String prompt = "Prompt";

		Object[] message = { prompt, null, nameLabel, nameField, pathLabel, pathPanel, sizeLabel, sizePanel };

		JOptionPane pane = new JOptionPane(message, JOptionPane.PLAIN_MESSAGE, JOptionPane.OK_CANCEL_OPTION);
		pane.createDialog(null, "New Model").setVisible(true);
	}

	@Override
	public void actionPerformed(ActionEvent e)
	{
		Object o = e.getSource();

		if (o == pathButton)
		{
			Path path = PathInput.showDialog("Select working directory");
			if (path != null)
				pathField.setText(path.toString());
		}
	}
}
