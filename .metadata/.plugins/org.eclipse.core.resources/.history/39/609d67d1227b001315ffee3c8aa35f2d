package xoric.prism.swing.input;

import java.awt.BorderLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JButton;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JTextField;

import xoric.prism.data.types.Path;

public class OpenFileDialog implements ActionListener
{
	private final JPanel pathPanel0;
	private final JTextField fileField;
	private final JPanel filePanel;
	private final JButton pathButton;

	private final Object[] message;

	private final String title;

	public OpenFileDialog(String title, String caption)
	{
		this.title = title;

		// working directory
		JLabel pathLabel = new JLabel(caption);
		pathPanel0 = new JPanel(new BorderLayout());
		pathPanel0.add(BorderLayout.CENTER, pathLabel);
		filePanel = new JPanel(new BorderLayout());
		fileField = new JTextField("");
		pathButton = new JButton("...");
		pathButton.addActionListener(this);
		filePanel.add(BorderLayout.CENTER, fileField);
		filePanel.add(BorderLayout.EAST, pathButton);

		message = new Object[] { null, null, pathPanel0, filePanel };
	}

	public Path getResult()
	{
		Path path = new Path(fileField.getText());

		return path;
	}

	public boolean show()
	{
		int n = JOptionPane.showConfirmDialog(null, message, "Open Model", JOptionPane.OK_CANCEL_OPTION, JOptionPane.INFORMATION_MESSAGE);
		return n == JOptionPane.OK_OPTION;
	}

	@Override
	public void actionPerformed(ActionEvent e)
	{
		Object o = e.getSource();

		if (o == pathButton)
		{
			Path path = PathInput.showDialog(title);
			if (path != null)
				fileField.setText(path.toString());
		}
	}
}
