package xoric.prism.world.map;

import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;

import xoric.prism.data.IPackable;
import xoric.prism.data.IPoint_r;
import xoric.prism.data.IntPacker;
import xoric.prism.data.Point;

public class Map implements IPackable
{
	// size information (tiles and pixels)
	private Point tileCount;
	private Point size;

	// layers
	private TileLayer groundLayer;
	private RoutingLayer routingLayer;

	public Map()
	{
		// size information
		tileCount = new Point(0, 0);
		size = new Point(0, 0);

		// layers
		groundLayer = new TileLayer();
		routingLayer = new RoutingLayer();
	}

	public void setSize(int tilesX, int tilesY)
	{
		// update size information
		tileCount.x = tilesX;
		tileCount.y = tilesY;
		size.x = tilesX * Tile.WIDTH;
		size.y = tilesY * Tile.HEIGHT;

		// update layers
		groundLayer.setSize(tilesX, tilesY);
		routingLayer.setSize(tilesX, tilesY);
	}

	/**
	 * Returns the number of tiles in x- and y-direction.
	 * @return IPoint_r
	 */
	public IPoint_r getTileCount()
	{
		return tileCount;
	}

	/**
	 * Returns width and height of the Map in pixels.
	 * @return IPoint_r
	 */
	public IPoint_r getSize()
	{
		return size;
	}

	@Override
	public void pack(OutputStream stream) throws IOException
	{
		tileCount.pack(stream);
	}

	@Override
	public void unpack(InputStream stream) throws IOException
	{
		tileCount.unpack(stream);
setSize(tileCount.x, tileCount.y);
		
	}

	@Override
	public int getPackedSize()
	{
		// TODO Auto-generated method stub
		return 0;
	}
}
