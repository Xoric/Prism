package xoric.prism.develop.meta;

import java.io.File;
import java.io.FileInputStream;

import xoric.prism.data.modules.ErrorCode;
import xoric.prism.data.modules.ErrorID;
import xoric.prism.data.modules.IActor;
import xoric.prism.exceptions.PrismDevException;

class AttachmentWriter implements IActor
{
	private final File file;
	private byte[] content;

	public AttachmentWriter(File file)
	{
		this.file = file;
	}

	public void load()
	{
		int originalSize = (int) file.length();
		if (originalSize <= 0)
		{
			ErrorCode c = new ErrorCode(this, ErrorID.FILE_NOT_FOUND);
			PrismDevException e = new PrismDevException(c);
			e.appendInfo("file", file.toString());
			throw e;
		}

		try
		{
			content = new byte[originalSize];
			FileInputStream in = new FileInputStream(file);
			in.read(content);
			in.close();
		}
		catch (Exception e0)
		{
			ErrorCode c = new ErrorCode(this, ErrorID.READ_ERROR);
			PrismDevException e = new PrismDevException(c);
			e.appendOriginalException(e0);
			e.appendInfo("file", file.toString());
			throw e;
		}
	}
}
