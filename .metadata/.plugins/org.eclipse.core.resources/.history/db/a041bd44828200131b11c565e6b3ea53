package xoric.prism.server.main;

import xoric.prism.data.time.PrismClock;

public class ServerLoop extends Thread
{
	private static ServerLoop instance;

	private volatile boolean isStopRequested;

	private ServerLoop()
	{
	}

	public static void startThread(ServerModel model)
	{
		requestStopThread();

		instance = new ServerLoop();
	}

	public static void requestStopThread()
	{
		if (instance != null)
			instance.requestStop();
	}

	public void run(ServerModel model)
	{
		PrismClock clock = new PrismClock();
		isStopRequested = false;

		System.out.println("starting server loop");

		do
		{
			//			int startMs = clock.getTimeMs();

			model.net.update();

		}
		while (!isStopRequested);

		System.out.println("server loop stopped");
	}

	public void requestStop()
	{
		isStopRequested = true;
	}
}
