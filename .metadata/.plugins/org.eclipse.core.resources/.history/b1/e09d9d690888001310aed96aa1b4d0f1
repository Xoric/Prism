package xoric.prism.creator.custom.control;

import java.io.File;
import java.io.IOException;

import javax.swing.JOptionPane;

import xoric.prism.creator.common.spritelist.control.SpriteNameGenerator;
import xoric.prism.creator.custom.model.ObjectModel;
import xoric.prism.creator.custom.model.SpriteCollectionModel;
import xoric.prism.data.types.IPath_r;
import xoric.prism.data.types.Text;
import xoric.prism.swing.input.PrismTextDialog;

public abstract class ObjectControl
{
	public static void addObject(SpriteCollectionModel model)
	{
		ObjectModel m = null;
		Text name = PrismTextDialog.getInstance().showDialog("New Object", "Object name (optional)", "NEW OBJECT");

		if (name != null)
		{
			m = new ObjectModel(name);
			model.addObject(m);

			try
			{
				model.save();
			}
			catch (IOException e)
			{
				JOptionPane.showMessageDialog(null, "There was an I/O error while trying to save changes: " + e.toString(), "Add Object",
						JOptionPane.WARNING_MESSAGE);
			}
		}
	}

	public static void deleteObject(SpriteCollectionModel model, int index)
	{
		if (model != null)
		{
			ObjectModel m = model.getObjectModel(index);
			String name = m.getName().toString().toLowerCase();
			IPath_r path = model.getPath();

			SpriteNameGenerator s = new SpriteNameGenerator(path, name + ".var", ".png");

			int i = 0;
			boolean b;
			do
			{
				File f = s.getFile(i);
				b = f.exists();
				
				++i;
			}
			while (b);

			model.deleteObject(index);

		}
	}
}
