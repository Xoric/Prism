package xoric.prism.creator.drawer.view;

import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.image.BufferedImage;
import java.io.File;
import java.util.ArrayList;
import java.util.List;

import javax.imageio.ImageIO;
import javax.swing.JLabel;
import javax.swing.Timer;

import xoric.prism.creator.drawer.model.AnimationModel;
import xoric.prism.creator.drawer.model.SpriteNames;
import xoric.prism.data.types.IPath_r;
import xoric.prism.world.animations.AnimationIndex;
import xoric.prism.world.entities.ViewAngle;

public class PreviewFrame implements ActionListener
{
	private final JLabel imageLabel;
	private final Timer timer;

	private final List<BufferedImage> images;
	private int durationMs;

	public PreviewFrame()
	{
		imageLabel = new JLabel();
		images = new ArrayList<BufferedImage>();
		timer = new Timer(200, this);
	}

	public void loadAndPlay(AnimationModel m, ViewAngle v)
	{
		AnimationIndex a = m.getAnimationIndex();
		IPath_r path = m.getPath();
		load(path,a, v);

		durationMs = m.getDurationMs();
	}

	public void load(IPath_r path, AnimationIndex a, ViewAngle v)
	{
		images.clear();

		int n = 0;
		boolean b;
		do
		{
			String filename = SpriteNames.getFilename(a, v, n);
			File file = path.getFile(filename);
			b = file.exists();
			if (b)
			{
				BufferedImage bi = ImageIO.read(file);
				images.add(bi);
			}
		}
		while (b);
	}

	@Override
	public void actionPerformed(ActionEvent e)
	{
		// TODO Auto-generated method stub

	}
}
