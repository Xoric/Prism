package xoric.prism.meta;

import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.util.Calendar;

import xoric.prism.data.IPackable;

public class TimeStamp implements IPackable
{
	private final int year;
	private final int month;
	private final int day;
	private final int hour;

	public TimeStamp()
	{
		Calendar c = Calendar.getInstance();

		year = c.get(Calendar.YEAR);
		month = c.get(Calendar.MONTH) + 1;
		day = c.get(Calendar.DAY_OF_MONTH);
		hour = c.get(Calendar.HOUR_OF_DAY);
	}

	@Override
	public String toString()
	{
		return year + "/" + month + "/" + day + "-" + hour;
	}

	@Override
	public void pack(OutputStream stream) throws IOException
	{
		// [YYYYYYYY] [YY|MMMM|DD] [DDD|HHHHH]
		int i = hour | (day << 5) | (month << 10) | ((year - 2013) << 14);
		stream.write(i);
		stream.write(i >> 8);
		stream.write(i >> 16);
	}

	@Override
	public void unpack(InputStream stream) throws IOException
	{
		int i = stream.read();
		i|= stream.read();
		i|= stream.read();

	}

	@Override
	public int getPackedSize()
	{
		// TODO Auto-generated method stub
		return 0;
	}

	public static void main(String[] args)
	{
		TimeStamp t = new TimeStamp();
		System.out.println(t.toString());
	}
}
