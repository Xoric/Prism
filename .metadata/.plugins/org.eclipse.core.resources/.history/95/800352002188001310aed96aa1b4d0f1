package xoric.prism.creator.custom.creators;

import java.awt.image.BufferedImage;
import java.io.File;
import java.util.ArrayList;
import java.util.List;

import javax.imageio.ImageIO;

import xoric.prism.creator.common.spritelist.control.SpriteNameGenerator;
import xoric.prism.data.exceptions.PrismException;
import xoric.prism.data.types.Point;

class ObjectImages
{
	private final List<BufferedImage> images;

	public ObjectImages()
	{
		this.images = new ArrayList<BufferedImage>();
	}

	public void load(SpriteNameGenerator spriteNameGenerator) throws PrismException
	{
		int i = 0;
		boolean resume;

		images.clear();

		do
		{
			File f = spriteNameGenerator.getFile(i);
			resume = f.exists();

			if (resume)
			{
				try
				{
					BufferedImage bi = ImageIO.read(f);
					images.add(bi);
				}
				catch (Exception e0)
				{
					PrismException e = new PrismException(e0);
					e.setText("Image could not be loaded.");
					e.addInfo("image", f.toString());
					throw e;
				}
			}
		}
		while (resume);
	}

	private Point findHighestDimensions()
	{
		Point p = new Point();

		for (int i = 0; i < objects.size(); ++i)
		{
			ObjectImages o = objects.get(i);
			Point max = o.findHighestDimensions();

			if (i == 0 || max.getX() > p.getX())
				p.x = max.getX();
			if (i == 0 || max.getY() > p.getY())
				p.y = max.getY();
		}
		return p;
	}
}
